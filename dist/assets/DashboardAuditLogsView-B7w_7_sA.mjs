import{d as I,r as p,o as v,l as D,c as l,a as n,b as t,e as S,f as m,v as x,k as w,F as U,h as L,t as u,n as h,A as d,_ as C}from"./index-C1nZs7mf.mjs";var r=(s=>(s.USER_LOGIN="USER_LOGIN",s.USER_LOGOUT="USER_LOGOUT",s.PASSWORD_RESET="PASSWORD_RESET",s.ACCESS_DENIED="ACCESS_DENIED",s))(r||{});const _={USER_LOGIN:"เข้าสู่ระบบ",USER_LOGOUT:"ออกจากระบบ",PASSWORD_RESET:"รีเซ็ตรหัสผ่าน",ACCESS_DENIED:"ถูกปฏิเสธการเข้าถึง"},O=[{id:1,timestamp:"2024-07-16 10:00:00",userId:"admin_001",action:r.USER_LOGIN,targetId:"admin_001",details:{ip:"192.168.1.1",device:"Desktop Chrome",status:"SUCCESS"}},{id:2,timestamp:"2024-07-16 10:05:30",userId:"admin_001",action:r.USER_LOGOUT,targetId:"admin_001",details:{duration:"5m 30s"}},{id:3,timestamp:"2024-07-16 10:15:00",userId:"system_auth",action:r.PASSWORD_RESET,targetId:"user_support",details:{method:"admin_override"}},{id:4,timestamp:"2024-07-15 15:30:00",userId:"guest",action:r.ACCESS_DENIED,targetId:"login_page",details:{ip:"103.25.1.5",reason:"Invalid credentials"}},{id:5,timestamp:"2024-07-14 09:00:00",userId:"user_support",action:r.USER_LOGIN,targetId:"user_support",details:{ip:"192.168.1.50",device:"Mobile Safari",status:"SUCCESS"}},{id:6,timestamp:"2024-07-14 09:05:00",userId:"hacker_bot",action:r.USER_LOGIN,targetId:"hacker_bot",details:{ip:"203.0.113.10",status:"FAILED",reason:"Incorrect Password"}}],R=async()=>(await new Promise(s=>setTimeout(s,300)),O),g=s=>{switch(s.action){case r.USER_LOGIN:return s.details.status==="SUCCESS"?`เข้าสู่ระบบสำเร็จจาก IP: ${s.details.ip}, Device: ${s.details.device}`:`เข้าสู่ระบบล้มเหลวจาก IP: ${s.details.ip}, เหตุผล: ${s.details.reason||"Unknown"}`;case r.USER_LOGOUT:return`ออกจากระบบหลังใช้งานนาน: ${s.details.duration}`;case r.PASSWORD_RESET:return`รีเซ็ตรหัสผ่านให้ User ID: ${s.targetId} ด้วยวิธี: ${s.details.method}`;case r.ACCESS_DENIED:return`ถูกปฏิเสธการเข้าถึง Resource: ${s.targetId} จาก IP: ${s.details.ip}, เหตุผล: ${s.details.reason}`;default:return JSON.stringify(s.details)||"ไม่มีรายละเอียดเพิ่มเติม"}},A={class:"p-6 bg-white rounded-lg shadow-2xl border border-gray-100"},N={class:"bg-gray-50 p-6 rounded-xl shadow-inner mb-8 grid grid-cols-1 md:grid-cols-3 gap-4"},T={class:"card bg-white p-0 rounded-xl shadow-xl"},k={key:0,class:"p-12 text-center text-gray-500"},G={key:1,class:"overflow-x-auto"},P={class:"min-w-full bg-white rounded-lg"},$={class:"text-gray-700 text-sm font-medium"},V={class:"py-3 px-6 text-left whitespace-nowrap"},W={class:"py-3 px-6 text-left font-mono text-xs"},M={class:"py-3 px-6 text-left font-semibold"},B={class:"py-3 px-6 text-left"},F=["title"],z={key:0},H=I({__name:"DashboardAuditLogsView",setup(s){const f=p([]),c=p(!0),o=p({user:"",action:"",date:""});v(async()=>{const i=await R();f.value=i,c.value=!1});const b=D(()=>f.value.filter(i=>{const e=i.userId.toLowerCase().includes(o.value.user.toLowerCase()),E=(_[i.action]||i.action).toLowerCase().includes(o.value.action.toLowerCase()),y=o.value.date?i.timestamp.startsWith(o.value.date):!0;return e&&E&&y}));return(i,e)=>(n(),l("div",A,[e[11]||(e[11]=t("h2",{class:"text-2xl font-bold text-gray-800 mb-4 flex items-center"},[t("i",{class:"fas fa-shield-alt mr-3 text-orange-600"}),S(" ประวัติการเข้าใช้งาน (Audit Logs) ")],-1)),e[12]||(e[12]=t("p",{class:"text-gray-700 mb-6"}," หน้านี้แสดงบันทึกกิจกรรมที่มีความสำคัญด้านการเข้าถึงและความปลอดภัยของระบบ Dashboard เท่านั้น. ",-1)),t("div",N,[t("div",null,[e[3]||(e[3]=t("label",{for:"filterUser",class:"block text-sm font-medium text-gray-700"},"ผู้กระทำ (User ID):",-1)),m(t("input",{type:"text",id:"filterUser","onUpdate:modelValue":e[0]||(e[0]=a=>o.value.user=a),placeholder:"ค้นหาด้วยรหัสผู้ใช้",class:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-2 focus:border-blue-500 focus:ring-blue-500 transition-colors"},null,512),[[x,o.value.user]])]),t("div",null,[e[4]||(e[4]=t("label",{for:"filterAction",class:"block text-sm font-medium text-gray-700"},"กิจกรรม:",-1)),m(t("input",{type:"text",id:"filterAction","onUpdate:modelValue":e[1]||(e[1]=a=>o.value.action=a),placeholder:"ค้นหาด้วยกิจกรรม",class:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-2 focus:border-blue-500 focus:ring-blue-500 transition-colors"},null,512),[[x,o.value.action]])]),t("div",null,[e[5]||(e[5]=t("label",{for:"filterDate",class:"block text-sm font-medium text-gray-700"},"วันที่:",-1)),m(t("input",{type:"date",id:"filterDate","onUpdate:modelValue":e[2]||(e[2]=a=>o.value.date=a),class:"mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-2 focus:border-blue-500 focus:ring-blue-500 transition-colors"},null,512),[[x,o.value.date]])])]),t("div",T,[e[9]||(e[9]=t("h3",{class:"text-xl font-semibold text-gray-800 p-4 border-b"}," รายการบันทึกกิจกรรมด้านความปลอดภัย ",-1)),c.value?(n(),l("div",k,e[6]||(e[6]=[t("i",{class:"fas fa-spinner fa-spin text-2xl mr-2"},null,-1),S(" กำลังโหลดบันทึกกิจกรรม... ")]))):(n(),l("div",G,[t("table",P,[e[8]||(e[8]=t("thead",null,[t("tr",{class:"bg-blue-50 text-left text-blue-800 uppercase text-xs tracking-wider"},[t("th",{class:"py-3 px-6 text-left"},"วันที่และเวลา"),t("th",{class:"py-3 px-6 text-left"},"ผู้กระทำ (Actor)"),t("th",{class:"py-3 px-6 text-left"},"Target/Resource"),t("th",{class:"py-3 px-6 text-left"},"กิจกรรม"),t("th",{class:"py-3 px-6 text-left"},"รายละเอียด")])],-1)),t("tbody",$,[(n(!0),l(U,null,L(b.value,a=>(n(),l("tr",{key:a.id,class:"border-b border-gray-100 hover:bg-yellow-50/50 transition-colors"},[t("td",V,u(new Date(a.timestamp).toLocaleString("th-TH")),1),t("td",W,u(a.userId),1),t("td",M,u(a.targetId||"-"),1),t("td",B,[t("span",{class:h([{"bg-green-100 text-green-700":a.action===d(r).USER_LOGIN&&a.details.status==="SUCCESS","bg-red-100 text-red-700":a.action===d(r).ACCESS_DENIED||a.action===d(r).USER_LOGIN&&a.details.status!=="SUCCESS","bg-blue-100 text-blue-700":a.action===d(r).USER_LOGOUT,"bg-orange-100 text-orange-700":a.action===d(r).PASSWORD_RESET},"px-3 py-1 rounded-full text-xs font-bold whitespace-nowrap"])},u(d(_)[a.action]),3)]),t("td",{class:"py-3 px-6 text-left max-w-lg truncate text-xs text-gray-500",title:d(g)(a)},u(d(g)(a)),9,F)]))),128)),b.value.length===0&&!c.value?(n(),l("tr",z,e[7]||(e[7]=[t("td",{colspan:"5",class:"py-8 text-center text-gray-500"}," ไม่พบบันทึกกิจกรรมที่ตรงกับเงื่อนไข. ",-1)]))):w("",!0)])])])),e[10]||(e[10]=t("div",{class:"mt-6 p-4 text-center border-t border-gray-100"},[t("button",{class:"bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors font-medium"}," โหลดเพิ่มเติม ")],-1))])]))}}),Y=C(H,[["__scopeId","data-v-ccf46daf"]]);export{Y as default};
