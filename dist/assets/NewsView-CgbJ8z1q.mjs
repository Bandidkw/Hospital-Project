import{d as I,r as d,B as q,l as g,C as B,s as M,o as P,c as r,a,b as t,k as y,t as i,f as L,v as R,g as z,n as F,F as S,h as D,j as G,e as n,p as H,D as K,A as O,R as W,E as Y,G as J,H as Q,_ as X}from"./index-C1nZs7mf.mjs";const Z={class:"max-w-6xl mx-auto px-4 py-10"},ee={class:"mb-8 text-center md:text-left"},te={class:"text-3xl md:text-4xl font-extrabold text-gray-900 flex items-center justify-center md:justify-start gap-3"},se={key:0,class:"text-2xl text-teal-600 font-medium"},le={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-10"},ae={class:"relative w-full sm:max-w-xs"},re={class:"flex items-center gap-2"},oe=["title"],ie={key:0,class:"mb-8 rounded-xl border border-red-300 bg-red-50 p-4 text-red-700 flex items-center justify-between shadow-lg",role:"alert"},ne={class:"flex items-center gap-2"},de=["aria-busy"],ue={key:0,class:"grid sm:grid-cols-2 lg:grid-cols-3 gap-8"},ce={key:1,class:"grid sm:grid-cols-2 lg:grid-cols-3 gap-8"},fe={class:"relative h-56 md:h-64 bg-gray-100 overflow-hidden rounded-t-2xl"},ge=["src","alt"],me=["href"],ve={key:2,class:"w-full h-full flex items-center justify-center text-gray-400"},xe={class:"absolute left-3 bottom-3"},be={class:"inline-flex items-center gap-1 text-xs font-medium px-2.5 py-1 rounded-full bg-white/95 text-gray-800 backdrop-blur-sm shadow-md"},pe={class:"p-5"},ye=["title"],he={class:"text-sm text-gray-600 mt-2 line-clamp-3 leading-relaxed"},we={class:"mt-5 pt-3 border-t border-gray-100 flex items-center justify-end"},_e=["href"],ke={key:0,class:"col-span-full text-center py-20 text-gray-400 border border-dashed rounded-xl bg-gray-50"},Ce={key:1,class:"flex items-center justify-center sm:justify-between mt-12 text-sm text-gray-600 flex-wrap gap-4"},je={class:"hidden sm:block"},Ue={class:"font-bold text-gray-800"},Ne={class:"font-bold text-gray-800"},Le={class:"font-bold text-teal-600"},Se={class:"flex items-center gap-2"},De=["disabled"],Ve={class:"font-bold text-teal-600 px-3 py-1.5 rounded-full bg-teal-50 shadow-inner text-xs"},Ae=["disabled"],Ee=I({__name:"NewsView",setup(Te){const m=d(!1),x=d(null),k=d([]),h=q(),b=d(""),p=d("date"),c=d(!1),o=d(1),f=d(9),V=g(()=>Object.fromEntries(B.map(({key:s,label:e})=>[s,e])));function A(s){try{return new Date(s).toLocaleDateString("th-TH",{year:"numeric",month:"short",day:"numeric"})}catch{return s}}function w(s){return s?/^https?:\/\//i.test(s)?s:`${"https://api.maetaeng.go.th/api/v1".replace(/\/+$/,"").replace(/\/api(\/v\d+)?$/i,"")}/${String(s).replace(/^\/+/,"")}`:""}function E(s){const e=s.target,l="data:image/svg+xml;utf8,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="600" height="400"><rect width="100%" height="100%" fill="#e5e7eb"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-family="sans-serif" font-size="18" fill="#4b5563">Image unavailable</text></svg>');e&&e.src!==l&&(e.src=l)}function C(s){return new Date(s.updatedAt||s.createdAt||s.date).getTime()}const j=g(()=>{const s=h.query.category;return s?V.value[s]||s:""}),T=g(()=>k.value.filter(s=>s.isPublished!==!1)),$=g(()=>{const s=h.query.category,e=b.value.trim().toLowerCase();let l=T.value;return s&&(l=l.filter(u=>u.category===s)),e&&(l=l.filter(u=>u.title.toLowerCase().includes(e))),l}),v=g(()=>{const s=[...$.value],e=c.value?1:-1;return p.value==="date"?s.sort((l,u)=>(C(l)-C(u))*e):s.sort((l,u)=>l.title.localeCompare(u.title)*e),s}),U=g(()=>{const s=(o.value-1)*f.value;return v.value.slice(s,s+f.value)});M([b,p,c,()=>h.query.category],()=>{o.value=1});async function N(){m.value=!0,x.value=null;try{const s=await Y();k.value=J(s??[])}catch(s){const e=Q(s)?s.response?.data?.message??s.message:"ไม่สามารถโหลดข่าวสารได้";x.value=e}finally{m.value=!1}}function _(s){return s?s.toLowerCase().endsWith(".pdf"):!1}return P(()=>{N()}),(s,e)=>(a(),r("main",Z,[t("header",ee,[t("h1",te,[e[5]||(e[5]=t("i",{class:"fas fa-bullhorn text-teal-600"},null,-1)),e[6]||(e[6]=t("span",null,"ข่าวสารและประกาศ",-1)),j.value?(a(),r("span",se," - "+i(j.value),1)):y("",!0)]),e[7]||(e[7]=t("p",{class:"text-gray-600 mt-1"},"อัปเดตข่าวสารล่าสุดของโรงพยาบาล",-1))]),t("div",le,[t("div",ae,[L(t("input",{type:"search","onUpdate:modelValue":e[0]||(e[0]=l=>b.value=l),placeholder:"ค้นหาหัวข้อข่าว...",class:"w-full pl-10 pr-4 py-2.5 rounded-xl border border-gray-300 focus:ring-4 focus:ring-teal-100 focus:border-teal-500 shadow-lg transition-all"},null,512),[[R,b.value,void 0,{trim:!0}]]),e[8]||(e[8]=t("i",{class:"fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"},null,-1))]),t("div",re,[e[10]||(e[10]=t("label",{class:"text-sm font-medium text-gray-700"},"เรียงตาม",-1)),L(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>p.value=l),class:"border rounded-xl text-sm py-2.5 px-4 focus:ring-4 focus:ring-teal-100 focus:border-teal-500 shadow-sm transition-all"},e[9]||(e[9]=[t("option",{value:"date"},"วันที่",-1),t("option",{value:"title"},"หัวข้อ",-1)]),512),[[z,p.value]]),t("button",{class:"p-2 border border-gray-300 rounded-xl bg-white hover:bg-teal-50 hover:border-teal-500 transition-all text-gray-600 hover:text-teal-600 shadow-sm",onClick:e[2]||(e[2]=l=>c.value=!c.value),title:c.value?"เรียง น้อย→มาก":"เรียง มาก→น้อย"},[t("i",{class:F(c.value?"fas fa-arrow-up":"fas fa-arrow-down")},null,2)],8,oe)])]),x.value?(a(),r("div",ie,[t("div",ne,[e[11]||(e[11]=t("i",{class:"fas fa-exclamation-triangle"},null,-1)),t("span",null,i(x.value),1)]),t("button",{onClick:N,class:"px-4 py-1.5 rounded-lg border border-red-300 bg-white hover:bg-red-100 text-sm font-medium transition-colors shadow-sm"}," ลองใหม่ ")])):y("",!0),t("section",{"aria-busy":m.value?"true":"false"},[m.value?(a(),r("div",ue,[(a(),r(S,null,D(6,l=>t("div",{key:l,class:"rounded-xl border border-gray-200 overflow-hidden bg-white shadow-lg animate-pulse","aria-hidden":"true"},e[12]||(e[12]=[G('<div class="h-56 bg-gray-100" data-v-4bbc8c39></div><div class="p-5 space-y-3" data-v-4bbc8c39><div class="h-5 bg-gray-200 rounded w-4/5" data-v-4bbc8c39></div><div class="h-3 bg-gray-100 rounded w-full" data-v-4bbc8c39></div><div class="h-3 bg-gray-100 rounded w-5/6" data-v-4bbc8c39></div></div>',2)]))),64))])):(a(),r("div",ce,[(a(!0),r(S,null,D(U.value,l=>(a(),r("article",{key:l.id,class:"group rounded-2xl border border-gray-200 overflow-hidden bg-white shadow-xl hover:shadow-2xl hover:border-teal-400 hover:scale-[1.01] transition-all duration-300 ease-in-out transform relative z-0"},[t("div",fe,[l.imageUrl&&!_(l.imageUrl)?(a(),r("img",{key:0,src:w(l.imageUrl),alt:l.title,class:"w-full h-full object-cover group-hover:scale-[1.05] transition-transform duration-500",onError:E},null,40,ge)):l.imageUrl&&_(l.imageUrl)?(a(),r("a",{key:1,href:w(l.imageUrl),target:"_blank",class:"w-full h-full flex items-center justify-center text-red-600 bg-red-50 hover:bg-red-100 transition-colors"},e[13]||(e[13]=[t("i",{class:"far fa-file-pdf text-6xl"},null,-1),t("span",{class:"sr-only"},"เปิดไฟล์ PDF",-1)]),8,me)):(a(),r("div",ve,e[14]||(e[14]=[t("i",{class:"far fa-image text-4xl"},null,-1)]))),e[16]||(e[16]=t("div",{class:"pointer-events-none absolute inset-x-0 bottom-0 h-20 bg-gradient-to-t from-black/60 to-transparent"},null,-1)),t("div",xe,[t("span",be,[e[15]||(e[15]=t("i",{class:"far fa-calendar"},null,-1)),n(i(A(l.date)),1)])])]),t("div",pe,[t("h2",{class:"text-xl font-bold text-gray-900 line-clamp-2 group-hover:text-teal-600 transition-colors",title:l.title},i(l.title),9,ye),t("p",he,i(l.excerpt||l.content),1),t("div",we,[l.imageUrl&&_(l.imageUrl)?(a(),r("a",{key:0,href:w(l.imageUrl),target:"_blank",class:"text-teal-600 text-sm font-semibold inline-flex items-center gap-1 hover:text-teal-700 transition-colors"},e[17]||(e[17]=[n(" เปิดไฟล์แนบ "),t("i",{class:"fas fa-file-download text-[11px]"},null,-1)]),8,_e)):(a(),H(O(W),{key:1,to:{name:"news-detail",params:{id:l.id}},class:"text-teal-600 text-sm font-semibold inline-flex items-center gap-1 hover:text-teal-700 transition-colors"},{default:K(()=>e[18]||(e[18]=[n(" อ่านต่อ "),t("i",{class:"fas fa-arrow-right text-[11px] group-hover:translate-x-1 transition"},null,-1)])),_:2,__:[18]},1032,["to"]))])])]))),128)),!U.value.length&&!m.value?(a(),r("div",ke,e[19]||(e[19]=[t("i",{class:"fas fa-inbox text-4xl mb-3"},null,-1),t("p",{class:"text-lg"},"ไม่พบข่าวสารที่ตรงกับเงื่อนไข",-1),t("p",{class:"text-sm mt-1"},"ลองใช้คำค้นหาอื่น หรือเลือกหมวดหมู่ใหม่",-1)]))):y("",!0)]))],8,de),v.value.length>f.value?(a(),r("div",Ce,[t("p",je,[e[20]||(e[20]=n(" แสดง ")),t("span",Ue,i((o.value-1)*f.value+1),1),e[21]||(e[21]=n(" – ")),t("span",Ne,i(Math.min(o.value*f.value,v.value.length)),1),e[22]||(e[22]=n(" จากทั้งหมด ")),t("span",Le,i(v.value.length),1),e[23]||(e[23]=n(" รายการ "))]),t("div",Se,[t("button",{class:"px-4 py-2 rounded-full border border-gray-300 bg-white hover:bg-teal-50 hover:border-teal-500 disabled:opacity-50 disabled:bg-gray-100 transition-colors shadow-sm text-sm font-medium",disabled:o.value<=1,onClick:e[3]||(e[3]=l=>o.value--)},e[24]||(e[24]=[t("i",{class:"fas fa-chevron-left mr-1 text-[10px]"},null,-1),n(" ก่อนหน้า ")]),8,De),t("span",Ve," หน้า "+i(o.value),1),t("button",{class:"px-4 py-2 rounded-full border border-gray-300 bg-white hover:bg-teal-50 hover:border-teal-500 disabled:opacity-50 disabled:bg-gray-100 transition-colors shadow-sm text-sm font-medium",disabled:o.value*f.value>=v.value.length,onClick:e[4]||(e[4]=l=>o.value++)},e[25]||(e[25]=[n(" ถัดไป "),t("i",{class:"fas fa-chevron-right ml-1 text-[10px]"},null,-1)]),8,Ae)])])):y("",!0)]))}}),Ie=X(Ee,[["__scopeId","data-v-4bbc8c39"]]);export{Ie as default};
