import{d as F,r as d,s as Q,p as S,a as r,D as I,c as u,k as g,w as T,m as M,U as E,b as e,t as x,F as A,h as U,f as V,n as W,v as B,_ as q,e as c,B as X,y as Z,u as ee,l as te,o as se,J as le}from"./index-C1nZs7mf.mjs";import{i as k}from"./itaService-Dn7tRidB.mjs";const oe={class:"flex justify-between items-center border-b pb-3 mb-6"},ae={class:"text-2xl font-bold text-gray-800"},ne={key:0},ie=["value"],re=["value"],ue={class:"space-y-4"},de=["readonly"],me={class:"flex justify-end space-x-4 pt-4 border-t"},pe=F({__name:"ItaTopicFormModal",props:{isOpen:{type:Boolean},isEditing:{type:Boolean},year:{},formData:{},moitTemplates:{}},emits:["close","save"],setup(O,{emit:y}){const m=O,n=y,t=d({...m.formData});Q(()=>m.formData,a=>{t.value={...a}},{deep:!0});const p=a=>{t.value.templateValue=a;const s=m.moitTemplates.find(i=>i.value===a);s?(t.value.moit_name=s.value,t.value.title=s.text,t.value.description=`รายละเอียดของ ${s.value}`):(t.value.moit_name="",t.value.title="",t.value.description="")},b=a=>{const s=a.target;s&&s.value!==void 0&&p(s.value)},w=()=>{n("save",t.value)};return(a,s)=>(r(),S(E,{name:"modal-fade"},{default:I(()=>[a.isOpen?(r(),u("div",{key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50",onClick:s[6]||(s[6]=T(i=>n("close"),["self"]))},[M(E,{name:"modal-slide"},{default:I(()=>[a.isOpen?(r(),u("div",{key:0,class:"bg-white rounded-lg shadow-xl p-8 max-w-2xl w-full mx-4",onClick:s[5]||(s[5]=T(()=>{},["stop"]))},[e("div",oe,[e("h2",ae,x(a.isEditing?"แก้ไขหัวข้อ":`สร้างหัวข้อใหม่สำหรับปี ${a.year}`),1),e("button",{onClick:s[0]||(s[0]=i=>n("close")),class:"text-gray-500 hover:text-gray-800"},s[7]||(s[7]=[e("i",{class:"fas fa-times text-xl"},null,-1)]))]),e("form",{onSubmit:T(w,["prevent"]),class:"space-y-6"},[a.isEditing?g("",!0):(r(),u("div",ne,[s[9]||(s[9]=e("label",{for:"moit-template",class:"block text-gray-700 font-bold mb-2"},"เลือกแม่แบบหัวข้อ (MOIT):",-1)),e("select",{id:"moit-template",value:t.value.templateValue,onChange:b,class:"shadow border rounded-lg w-full py-3 px-4 text-gray-700 transition duration-150 focus:ring-blue-500 focus:border-blue-500",required:""},[s[8]||(s[8]=e("option",{disabled:"",value:""},"-- กรุณาเลือกหัวข้อ --",-1)),(r(!0),u(A,null,U(a.moitTemplates,i=>(r(),u("option",{key:i.value,value:i.value},x(i.value)+": "+x(i.text.substring(0,100))+"... ",9,re))),128))],40,ie)])),e("div",ue,[e("div",null,[s[10]||(s[10]=e("label",{for:"moit_name",class:"block text-gray-700 font-bold mb-2"},"MOIT:",-1)),V(e("input",{id:"moit_name",type:"text","onUpdate:modelValue":s[1]||(s[1]=i=>t.value.moit_name=i),readonly:!!(!a.isEditing&&t.value.moit_name),class:W(["shadow border rounded-lg w-full py-3 px-4 text-gray-700 transition duration-150",{"bg-gray-100":!a.isEditing&&t.value.moit_name}]),required:""},null,10,de),[[B,t.value.moit_name]])]),e("div",null,[s[11]||(s[11]=e("label",{for:"title",class:"block text-gray-700 font-bold mb-2"},"ชื่อหัวข้อ:",-1)),V(e("input",{id:"title",type:"text","onUpdate:modelValue":s[2]||(s[2]=i=>t.value.title=i),class:"shadow border rounded-lg w-full py-3 px-4 text-gray-700 transition duration-150",required:""},null,512),[[B,t.value.title]])]),e("div",null,[s[12]||(s[12]=e("label",{for:"description",class:"block text-gray-700 font-bold mb-2"},"คำอธิบาย:",-1)),V(e("textarea",{id:"description","onUpdate:modelValue":s[3]||(s[3]=i=>t.value.description=i),rows:"3",class:"shadow border rounded-lg w-full py-3 px-4 text-gray-700 transition duration-150"},null,512),[[B,t.value.description]])])]),e("div",me,[e("button",{type:"button",onClick:s[4]||(s[4]=i=>n("close")),class:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-6 rounded-full transition duration-150"}," ยกเลิก "),s[13]||(s[13]=e("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-full transition duration-150"}," บันทึก ",-1))])],32)])):g("",!0)]),_:1})])):g("",!0)]),_:1}))}}),ve=q(pe,[["__scopeId","data-v-e5f8155e"]]),xe={class:"text-gray-700 mb-6 text-lg"},ce={class:"text-black block mt-1"},fe={class:"flex justify-end space-x-4"},ye=F({__name:"DeleteConfirmModal",props:{isOpen:{type:Boolean},itemTitle:{}},emits:["close","confirm"],setup(O,{emit:y}){const m=y;return(n,t)=>(r(),S(E,{name:"modal-fade"},{default:I(()=>[n.isOpen?(r(),u("div",{key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50",onClick:t[3]||(t[3]=T(p=>m("close"),["self"]))},[e("div",{class:"bg-white rounded-lg shadow-xl p-8 max-w-md w-full mx-4",onClick:t[2]||(t[2]=T(()=>{},["stop"]))},[t[9]||(t[9]=e("h3",{class:"text-2xl font-bold text-red-700 mb-4 flex items-center"},[e("i",{class:"fas fa-exclamation-triangle mr-3"}),c("ยืนยันการลบ ")],-1)),e("p",xe,[t[4]||(t[4]=c(" คุณแน่ใจหรือไม่ว่าต้องการลบรายการนี้: ")),t[5]||(t[5]=e("br",null,null,-1)),e("strong",ce,'"'+x(n.itemTitle)+'"',1),t[6]||(t[6]=c("? ")),t[7]||(t[7]=e("br",null,null,-1)),t[8]||(t[8]=e("span",{class:"text-sm text-red-600"},"การกระทำนี้ไม่สามารถกู้คืนได้",-1))]),e("div",fe,[e("button",{onClick:t[0]||(t[0]=p=>m("close")),class:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-5 rounded-full transition duration-150"}," ยกเลิก "),e("button",{onClick:t[1]||(t[1]=p=>m("confirm")),class:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-5 rounded-full transition duration-150"}," ยืนยันการลบ ")])])])):g("",!0)]),_:1}))}}),be=q(ye,[["__scopeId","data-v-01bf8031"]]),ge={class:"container mx-auto p-8 bg-white rounded-lg shadow-xl"},we={key:0,class:"mb-8"},Te={class:"flex justify-between items-center border-b-4 border-blue-500 pb-4"},_e={class:"text-4xl font-extrabold text-blue-800"},ke={key:1,class:"text-center py-16"},Me={key:2,class:"text-center py-16 bg-red-50 p-8 rounded-lg"},Ie={class:"text-xl text-red-600"},Oe={key:3,class:"overflow-x-auto rounded-lg border border-gray-200 shadow-sm"},Ce={class:"min-w-full divide-y divide-gray-200"},$e={class:"bg-white divide-y divide-gray-200"},he={key:0},De={class:"px-6 py-4 whitespace-nowrap text-gray-700"},Ve={class:"px-6 py-4 text-gray-700"},Be={class:"px-6 py-4 text-gray-700"},Ee={class:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium space-x-2"},Fe=["onClick"],Ne=["onClick"],je=["onClick"],Ue=F({__name:"ItaTopicListView",setup(O){const y=X(),m=Z(),n=ee(),t=te(()=>y.params.yearId??y.params.id),p=d(null),b=d([]),w=d(!0),a=d(null),s=d(!1),i=d(!1),C=d({id:"",templateValue:"",moit_name:"",title:"",description:""}),$=d(!1),f=d(null),z=[{value:"MOIT 1",text:"หน่วยงานมีการวางระบบโดยการกำหนดมาตรการการเผยแพร่ข้อมูลต่อสาธารณะ ผ่านเว็บไซต์ของหน่วยงาน"},{value:"MOIT 2",text:"หน่วยงานมีการเปิดเผยข้อมูลข่าวสารที่เป็นปัจจุบัน"},{value:"MOIT 3",text:"หน่วยงานมีรายงานการวิเคราะห์ผลการจัดซื้อจัดจ้างและการจัดหาพัสดุประจำปีงบประมาณ"},{value:"MOIT 4",text:"หน่วยงานมีการวางระบบการจัดซื้อจัดจ้างและการจัดหาพัสดุ ประจำปีงบประมาณ"},{value:"MOIT 5",text:"หน่วยงานมีการสรุปผลการจัดซื้อจัดจ้างและการจัดหาพัสดุรายเดือน ประจำปีงบประมาณ"},{value:"MOIT 6",text:"ผู้บริหารแสดงนโยบายการบริหารและพัฒนาทรัพยากรบุคคล"},{value:"MOIT 7",text:"หน่วยงานมีการรายงานการประเมินและเกี่ยวกับการประเมินผลการปฏิบัติราชการของบุคลากรในหน่วยงาน และเปิดเผยผลการปฏิบัติราชการ ระดับดีเด่น และระดับดีมาก ในที่เปิดเผยให้ทราบ"},{value:"MOIT 8",text:"หน่วยงานมีการอบรมให้ความรู้แก่เจ้าหน้าที่ภายในหน่วยงานเกี่ยวกับการเสริมสร้างและพัฒนาทางด้านจริยธรรม และการรักษาวินัยรวมทั้งการป้องกันมิให้กระทำผิดวินัย"},{value:"MOIT 9",text:"หน่วยงานมีแนวปฏิบัติการจัดการเรื่องร้องเรียน และช่องทางการร้องเรียน"},{value:"MOIT 10",text:"หน่วยงานมีสรุปผลการดำเนินงานเรื่องรัองเรียนการปฏิบัติงานหรือการให้บริการของเจ้าหน้าที่ภายในหน่วยงาน และเรื่องร้องเรียนการทุจริตและประพฤติมิชอบ"},{value:"MOIT 11",text:"หน่วยงานของท่านเปิดโอกาสให้ผู้มีส่วนได้ส่วนเสียมีโอกาสเข้ามามีส่วนร่วมในการดำเนินงานตามภารกิจของหน่วยงาน"},{value:"MOIT 12",text:'หน่วยงานมีมาตรการ "การป้องกันการรับสินบน" ที่เป็นระบบ'},{value:"MOIT 13",text:"หน่วยงานประเมินการดำเนินการตามแนวทางปฏิบัติของหน่วยงาน ในปีงบประมาณตามเกณฑ์จริยธรรมการจัดซื้อจัดหาและการส่งเสริมการขายยาและเวชภัณฑ์ที่มิใช่ยาของกระทรวงสาธารณสุข พ.ศ. 2564"},{value:"MOIT 14",text:"หน่วยงานมีแนวทางปฏิบัติเกี่ยวกับการใช้ทรัพย์สินของราชการ และมีขั้นตอนการขออนุญาตเพื่อยืมทรัพย์สินของราชการไปใช้ปฏิบัติในหน่วยงานที่ถูกต้อง"},{value:"MOIT 15",text:"หน่วยงานมีแผนปฏิบัติการป้องกัน ปราบปรามการทุจริตและประพฤติมิชอบ และแผนปฏิบัติการส่งเสริมคุณธรรมของชมรมจริยธรรม ประจำปีงบประมาณ"},{value:"MOIT 16",text:"หน่วยงานมีรายงานการกำกับติดตามการดำเนินงานตามแผนปฏิบัติการป้องกัน ปราบปรามการทุจริตและประพฤติมิชอบ"},{value:"MOIT 17",text:"หน่วยงานมีการประเมินความเสี่ยงการทุจริต ประจำปีงบประมาณอย่างเป็นระบบ"},{value:"MOIT 18",text:"หน่วยงานมีการปฏิบัติตามมาตรการป้องกันการทุจริต (การควบคุมความเสี่ยงการทุจริต)"},{value:"MOIT 19",text:"หน่วยงานมีการรายงานผลการส่งเสริมการปฏิบัติตามประมวลจริยธรรมข้าราชการพลเรือน:กรณีการเรี่ยไรและกรณีการให้หรือรับของขวัญหรือประโยชน์อื่นใด ประจำปีงบประมาณ"},{value:"MOIT 20",text:"หน่วยงานมีการอบรมให้ความรู้ภายในหน่วยงาน เรื่อง ผลประโยชน์ทับซ้อนในหลักสูตร ต้านทุจริตศึกษา(Anti-Corruption Education)กระทรวงสาธารณสุข (ฉบับปรับปรุง) พ.ศ.2565"},{value:"MOIT 21",text:"หน่วยงานมีการเผยแพร่เจตจำนงสุจริตของการปฏิบัติหน้าที่ราชการ และนโยบายที่เคารพ สิทธิมนุษยชนและศักดิ์ศรีของผู้ปฏิบัติงานและของผู้บริหาร ต่อสาธารณชน"},{value:"MOIT 22",text:"หน่วยงานมีแนวปฏิบัติที่เคารพสิทธิมนุษยชนและศักดิ์ศรีของผู้ปฏิบัติงาน และรายงานการป้องกันและแก้ไขปัญหาการล่วงละเมิดหรือคุกคามทางเพศในการทำงาน ประจำปีงบประมาณ"}],h=async()=>{w.value=!0,a.value=null;try{if(!t.value){a.value="ไม่พบ yearId ในเส้นทาง";return}const o=await k.getYearById(t.value);p.value=o,b.value=(o.moits??[]).sort((l,D)=>{const v=l.moit_name??"",_=D.moit_name??"",K=parseInt(v.replace(/\D/g,""),10)||0,P=parseInt(_.replace(/\D/g,""),10)||0;return K-P})}catch(o){o instanceof Error?a.value=o.message:a.value="เกิดข้อผิดพลาดที่ไม่คาดคิด",n.error(a.value)}finally{w.value=!1}},L=()=>{i.value=!1,C.value={id:"",templateValue:"",moit_name:"",title:"",description:""},s.value=!0},R=o=>{i.value=!0,C.value={id:o.id,templateValue:"",moit_name:o.moit_name,title:o.title,description:o.description||""},s.value=!0},N=()=>{s.value=!1},Y=async o=>{try{if(o.id){const l={moit_name:o.moit_name,title:o.title,description:o.description};n.info(`กำลังอัปเดตข้อมูล "${l.moit_name}"...`),await k.updateTopic(o.id,l),n.success("อัปเดตข้อมูลสำเร็จ!")}else{if(!t.value){n.error("ไม่พบรหัสปี (yearId)");return}if(!o.moit_name){n.error("กรุณาเลือกหัวข้อแม่แบบ");return}const l={year_ita_id:t.value,moit_name:o.moit_name,title:o.title,description:o.description};n.info(`กำลังสร้างหัวข้อ: "${l.moit_name}"...`),await k.createTopic(l),n.success("สร้างหัวข้อสำเร็จ!")}N(),await h()}catch(l){n.error(l instanceof Error?l.message:"เกิดข้อผิดพลาดในการบันทึกข้อมูล")}},J=o=>{m.push(`/dashboard/ita/topic/${o}/edit`)},G=o=>{f.value=o,$.value=!0},j=()=>{$.value=!1,f.value=null},H=async()=>{if(f.value)try{n.info(`กำลังลบ "${f.value.title}"...`),await k.deleteTopic(f.value.id),n.success(`ลบ "${f.value.title}" สำเร็จ!`),j(),await h()}catch(o){n.error(o instanceof Error?o.message:"เกิดข้อผิดพลาดในการลบหัวข้อ")}};return se(h),(o,l)=>{const D=le("router-link");return r(),u("div",ge,[p.value?(r(),u("div",we,[M(D,{to:"/dashboard/ita",class:"text-blue-600 hover:underline text-lg mb-4 inline-block"},{default:I(()=>l[0]||(l[0]=[e("i",{class:"fas fa-arrow-left mr-2"},null,-1),c("กลับไปหน้าจัดการปี ")])),_:1,__:[0]}),e("div",Te,[e("div",null,[e("h1",_e," จัดการหัวข้อ ITA ปีงบประมาณ "+x(p.value.year),1),l[1]||(l[1]=e("p",{class:"text-gray-600 mt-2 text-lg"},"สร้างหรือจัดการหัวข้อหลัก (MOIT) สำหรับปีนี้",-1))]),e("button",{onClick:L,class:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-full focus:outline-none focus:shadow-outline transform transition duration-300 hover:scale-105 shadow-lg flex items-center"},l[2]||(l[2]=[e("i",{class:"fas fa-plus mr-2"},null,-1),c(" สร้างหัวข้อใหม่ ")]))])])):g("",!0),w.value?(r(),u("div",ke,l[3]||(l[3]=[e("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-500"},null,-1),e("p",{class:"mt-4 text-xl text-gray-600"},"กำลังโหลดรายการหัวข้อ...",-1)]))):a.value?(r(),u("div",Me,[e("p",Ie,"เกิดข้อผิดพลาด: "+x(a.value),1)])):(r(),u("div",Oe,[e("table",Ce,[l[8]||(l[8]=e("thead",{class:"bg-blue-100"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider w-1/6"}," MOIT "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider w-2/5"}," ชื่อหัวข้อ "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider w-2/5"}," คำอธิบาย "),e("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-600 uppercase tracking-wider"}," การจัดการ ")])],-1)),e("tbody",$e,[!b.value||b.value.length===0?(r(),u("tr",he,l[4]||(l[4]=[e("td",{colspan:"4",class:"px-6 py-4 text-center text-gray-500"}," ยังไม่มีหัวข้อสำหรับปีงบประมาณนี้ ",-1)]))):g("",!0),(r(!0),u(A,null,U(b.value,v=>(r(),u("tr",{key:v.id,class:"hover:bg-gray-50"},[e("td",De,x(v.moit_name),1),e("td",Ve,x(v.title),1),e("td",Be,x(v.description||"-"),1),e("td",Ee,[e("button",{onClick:_=>J(v.id),class:"inline-flex items-center px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md shadow-sm hover:bg-green-700 transition duration-150"},l[5]||(l[5]=[e("i",{class:"fas fa-folder-open mr-2"},null,-1),c("จัดการเอกสาร ")]),8,Fe),e("button",{onClick:_=>R(v),class:"inline-flex items-center px-4 py-2 bg-yellow-400 text-gray-800 text-sm font-medium rounded-md hover:bg-yellow-500 transition duration-150"},l[6]||(l[6]=[e("i",{class:"fas fa-pencil-alt mr-2"},null,-1),c("แก้ไข ")]),8,Ne),e("button",{onClick:_=>G(v),class:"inline-flex items-center px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-md shadow-sm hover:bg-red-700 transition duration-150"},l[7]||(l[7]=[e("i",{class:"fas fa-trash-alt mr-2"},null,-1),c("ลบ ")]),8,je)])]))),128))])])])),M(ve,{isOpen:s.value,isEditing:i.value,year:Number(p.value?.year??0),formData:C.value,moitTemplates:z,onClose:N,onSave:Y},null,8,["isOpen","isEditing","year","formData"]),M(be,{isOpen:$.value,itemTitle:f.value?.title??"รายการนี้",onClose:j,onConfirm:H},null,8,["isOpen","itemTitle"])])}}});export{Ue as default};
