import{d as $,u as S,r as g,s as P,c as d,a,w as h,b as e,f as U,k as x,e as m,v as D,n as T,q as z,g as O,t as y,F as R,h as G,o as H,m as w,p as M,D as V,U as B,a0 as F,a2 as J,a3 as Q,a4 as W,a5 as X,a6 as Y,_ as Z}from"./index-C1nZs7mf.mjs";const ee=["onKeydown","disabled"],te={key:0,class:"text-xs text-gray-500 mt-1"},se={key:1,class:"text-xs text-red-500 mt-1"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},oe=["required"],ae={key:0,class:"text-xs text-gray-500 mt-1"},le={class:"relative"},ne={class:"flex justify-end space-x-3 pt-6 border-t border-gray-100"},ie={type:"submit",class:"bg-indigo-600 text-white font-bold tracking-wide px-8 py-2.5 rounded-xl shadow-lg hover:bg-indigo-800 transition duration-300 transform hover:scale-105"},de=$({__name:"UserForm",props:{currentUser:{},opdUser:{type:Boolean}},emits:["saveUser","cancelEdit"],setup(k,{emit:c}){const f=k,l=c,n=S(),s=g({...f.currentUser});P(()=>f.currentUser,o=>{s.value={...o}},{deep:!0});const p=()=>{n.warning("ชื่อผู้ใช้งานห้ามมีช่องว่าง")},b=()=>{l("saveUser",s.value)};return(o,t)=>(a(),d("form",{onSubmit:h(b,["prevent"]),class:"space-y-6"},[e("div",null,[t[5]||(t[5]=e("label",{for:"username",class:"block text-sm font-bold text-gray-800 mb-1"},[e("i",{class:"fas fa-user mr-2 text-indigo-500"}),m(" ชื่อผู้ใช้งาน: ")],-1)),U(e("input",{type:"text",id:"username","onUpdate:modelValue":t[0]||(t[0]=u=>s.value.username=u),onKeydown:z(h(p,["prevent"]),["space"]),onInput:t[1]||(t[1]=u=>s.value.username=s.value.username.replace(/\s/g,"")),class:T(["block w-full border border-gray-300 rounded-lg shadow-sm p-3 bg-gray-50 focus:ring-indigo-500 focus:border-indigo-500 transition duration-150",{"bg-gray-100 text-gray-500":o.opdUser}]),required:"",disabled:o.opdUser,placeholder:"ตัวอย่าง: admin (ห้ามมีช่องว่าง)"},null,42,ee),[[D,s.value.username]]),o.opdUser?x("",!0):(a(),d("p",te,"* ชื่อผู้ใช้งานต้องไม่มีช่องว่าง")),o.opdUser?(a(),d("p",se,"**ไม่สามารถแก้ไขชื่อผู้ใช้งานได้**")):x("",!0)]),e("div",re,[e("div",null,[t[6]||(t[6]=e("label",{for:"password",class:"block text-sm font-bold text-gray-800 mb-1"},[e("i",{class:"fas fa-lock mr-2 text-indigo-500"}),m(" รหัสผ่าน: ")],-1)),U(e("input",{type:"password",id:"password","onUpdate:modelValue":t[2]||(t[2]=u=>s.value.password=u),class:"block w-full border border-gray-300 rounded-lg shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500 transition duration-150",required:!o.opdUser},null,8,oe),[[D,s.value.password]]),o.opdUser?(a(),d("p",ae," เว้นว่างไว้หาก **ไม่ต้องการเปลี่ยน** รหัสผ่าน ")):x("",!0)]),e("div",null,[t[9]||(t[9]=e("label",{for:"role",class:"block text-sm font-bold text-gray-800 mb-1"},[e("i",{class:"fas fa-crown mr-2 text-indigo-500"}),m(" บทบาท: ")],-1)),e("div",le,[U(e("select",{id:"role","onUpdate:modelValue":t[3]||(t[3]=u=>s.value.role=u),class:"block w-full border border-gray-300 rounded-lg shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500 bg-white appearance-none pr-10 transition duration-150",required:""},t[7]||(t[7]=[e("option",{value:"20"},"OPD (เจ้าหน้าที่)",-1),e("option",{value:"50"},"Admin (ผู้ดูแล)",-1),e("option",{value:"90"},"Superadmin (ผู้ดูแลสูงสุด)",-1)]),512),[[O,s.value.role]]),t[8]||(t[8]=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[e("i",{class:"fas fa-chevron-down text-xs"})],-1))])])]),e("div",ne,[e("button",ie,[t[10]||(t[10]=e("i",{class:"fas fa-save mr-2"},null,-1)),m(" "+y(o.opdUser?"บันทึกการแก้ไข":"เพิ่มผู้ใช้งาน"),1)]),o.opdUser?(a(),d("button",{key:0,type:"button",onClick:t[4]||(t[4]=u=>o.$emit("cancelEdit")),class:"bg-gray-200 text-gray-700 font-semibold px-8 py-2.5 rounded-xl shadow-md hover:bg-gray-300 transition duration-300"},t[11]||(t[11]=[e("i",{class:"fas fa-times mr-2"},null,-1),m(" ยกเลิก ")]))):x("",!0)])],32))}}),ue={class:"overflow-x-auto shadow-md rounded-lg"},ce={class:"min-w-full divide-y divide-gray-200"},pe={class:"bg-white divide-y divide-gray-200"},ge={key:0},me={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},xe={class:"px-6 py-4 whitespace-nowrap text-sm"},fe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},be={class:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium"},ye=["onClick"],ve=["onClick"],we=$({__name:"UsersList",props:{users:{},roleMapping:{}},emits:["edit","delete"],setup(k,{emit:c}){const f=l=>{switch(l){case"90":return"bg-purple-100 text-purple-800 border border-purple-300";case"50":return"bg-blue-100 text-blue-800 border border-blue-300";case"20":return"bg-green-100 text-green-800 border border-green-300";default:return"bg-gray-100 text-gray-800"}};return(l,n)=>(a(),d("div",ue,[e("table",ce,[n[3]||(n[3]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider"}," ชื่อผู้ใช้งาน "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider"}," บทบาท "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider"}," ขอบเขตการจัดการ "),e("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-bold text-gray-500 uppercase tracking-wider"}," การกระทำ ")])],-1)),e("tbody",pe,[l.users.length===0?(a(),d("tr",ge,n[0]||(n[0]=[e("td",{colspan:"4",class:"px-6 py-4 text-center text-sm text-gray-500"}," ยังไม่มีข้อมูลผู้ใช้งานในระบบ ",-1)]))):x("",!0),(a(!0),d(R,null,G(l.users,s=>(a(),d("tr",{key:s.id,class:"hover:bg-gray-50 transition duration-150"},[e("td",me,y(s.username),1),e("td",xe,[e("span",{class:T([f(s.role),"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full"])},y(l.roleMapping[s.role]||"ไม่ระบุ"),3)]),e("td",fe,y(s.table),1),e("td",be,[e("button",{onClick:p=>l.$emit("edit",s),class:"text-indigo-600 hover:text-indigo-900 mr-4 transition duration-150",title:"แก้ไข"},n[1]||(n[1]=[e("i",{class:"fas fa-edit text-lg"},null,-1)]),8,ye),e("button",{onClick:p=>l.$emit("delete",s.id),class:"text-red-600 hover:text-red-900 transition duration-150",title:"ลบ"},n[2]||(n[2]=[e("i",{class:"fas fa-trash-alt text-lg"},null,-1)]),8,ve)])]))),128))])])]))}}),he={class:"p-6 bg-white rounded-lg shadow-xl"},ke={class:"bg-white p-8 rounded-xl shadow-2xl w-full max-w-lg transition-all transform duration-300 scale-100 opacity-100"},Ue={class:"flex justify-between items-center border-b pb-3 mb-4"},$e={class:"text-xl font-bold text-gray-800"},_e=$({__name:"DashboardUsersView",setup(k){const c=S(),f={20:"OPD",50:"Admin",90:"Superadmin"},l={id:"",username:"",role:"20",management:""},n=g([]),s=g({...l}),p=g(!1),b=g(!1),o=g(!1),t=g(null),u=async()=>{try{n.value=await J()}catch(i){c.error("ไม่สามารถดึงข้อมูลผู้ใช้งานได้"),console.error(i)}},j=()=>{s.value={...l},p.value=!1,o.value=!0},v=()=>{o.value=!1,K()},A=async i=>{try{const r=await Q(i.id);s.value={...r},p.value=!0,o.value=!0}catch(r){c.error("ไม่สามารถโหลดข้อมูลผู้ใช้งานเพื่อแก้ไขได้"),console.error(r)}},E=async i=>{try{if(p.value){const{id:r,username:Ce,password:De,...L}=i;await X(r,L),c.success("แก้ไขข้อมูลผู้ใช้งานสำเร็จ!")}else await Y(i),c.success("เพิ่มผู้ใช้งานใหม่สำเร็จ!");await u()}catch(r){c.error("บันทึกข้อมูลไม่สำเร็จ"),console.error(r)}},I=i=>{E(i),v()},q=i=>{t.value=i,b.value=!0},_=()=>{C()},N=async()=>{if(t.value!==null)try{await W(t.value),c.success("ลบผู้ใช้งานสำเร็จ!"),await u()}catch(i){c.error("ลบผู้ใช้งานไม่สำเร็จ"),console.error(i)}C()},K=()=>{s.value={...l},p.value=!1},C=()=>{t.value=null,b.value=!1};return H(()=>{u()}),(i,r)=>(a(),d("div",he,[r[5]||(r[5]=e("h1",{class:"text-3xl font-bold text-gray-800 mb-6 flex items-center"},[e("i",{class:"fas fa-users-cog mr-3 text-indigo-600"}),m(" จัดการผู้ใช้งาน ")],-1)),e("div",{class:"mb-6 flex justify-end"},[e("button",{onClick:j,class:"bg-green-600 text-white font-semibold px-6 py-2 rounded-lg shadow-md hover:bg-green-700 transition duration-300 transform hover:scale-105"},r[0]||(r[0]=[e("i",{class:"fas fa-plus-circle mr-2"},null,-1),m(" เพิ่มผู้ใช้งาน ")]))]),w(we,{users:n.value,"role-mapping":f,onEdit:A,onDelete:q},null,8,["users"]),(a(),M(F,{to:"body"},[w(B,{name:"fade"},{default:V(()=>[o.value?(a(),d("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm",onClick:h(v,["self"])},[e("div",ke,[e("div",Ue,[e("h3",$e,y(p.value?"แก้ไขผู้ใช้งาน":"เพิ่มผู้ใช้งานใหม่"),1),e("button",{onClick:v,class:"text-gray-400 hover:text-gray-600"},r[1]||(r[1]=[e("i",{class:"fas fa-times text-xl"},null,-1)]))]),w(de,{"current-user":s.value,"opd-user":p.value,onSaveUser:I,onCancelEdit:v},null,8,["current-user","opd-user"])])])):x("",!0)]),_:1})])),(a(),M(F,{to:"body"},[w(B,{name:"fade"},{default:V(()=>[b.value?(a(),d("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm",onClick:h(_,["self"])},[e("div",{class:"bg-white p-6 rounded-xl shadow-2xl w-full max-w-sm text-center"},[r[2]||(r[2]=e("i",{class:"fas fa-exclamation-triangle text-red-500 text-4xl mb-4"},null,-1)),r[3]||(r[3]=e("h3",{class:"text-lg font-bold mb-2"},"ยืนยันการลบผู้ใช้งาน",-1)),r[4]||(r[4]=e("p",{class:"text-gray-600 mb-6"},"คุณแน่ใจหรือไม่ที่จะลบผู้ใช้งานคนนี้?",-1)),e("div",{class:"flex justify-center space-x-4"},[e("button",{onClick:N,class:"bg-red-600 text-white font-semibold px-6 py-2 rounded-lg hover:bg-red-700 transition"}," ยืนยันการลบ "),e("button",{onClick:_,class:"bg-gray-300 text-gray-700 font-semibold px-6 py-2 rounded-lg hover:bg-gray-400 transition"}," ยกเลิก ")])])])):x("",!0)]),_:1})]))]))}}),Ve=Z(_e,[["__scopeId","data-v-cdc17281"]]);export{Ve as default};
